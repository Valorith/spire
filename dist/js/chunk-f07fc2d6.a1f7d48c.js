(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f07fc2d6"],{"093e":function(e,t,s){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"eq-window-simple"},[e.title?t("div",{staticClass:"eq-window-title-bar",style:"font-weight: "+(e.boldTitle?"bold":"normal")+";"},[e._v(e._s(e.title)+"\n  ")]):e._e(),t("div",{class:e.classes,style:"padding: "+("undefined"!==typeof e.padding?e.padding:10)+"px"},[e._t("default")],2)])},n=[],r=(s("c5f6"),{name:"EqWindowSimple",props:{title:{type:String,required:!1},padding:{type:Number,required:!1,default:10},classes:{type:String,required:!1,default:""},boldTitle:{type:Boolean,required:!1,default:!1}}}),i=r,l=s("2877"),o=Object(l["a"])(i,a,n,!1,null,"4db0cdea",null);t["a"]=o.exports},6359:function(e,t,s){"use strict";s("c216")},aef1:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("navbar"),t("div",{staticClass:"main-content"},[t("content-area",[e.isLocal?t("admin-header"):e._e(),t("router-view")],1)],1),t("footer"),t("back-to-top",{attrs:{bottom:"50px",right:"50px"}},[t("button",{staticClass:"btn btn-white btn-to-top",attrs:{type:"button"}},[t("i",{staticClass:"fa fa-chevron-up"})])])],1)},n=[],r=(s("96cf"),s("9ab4")),i=s("6afc"),l=s("96c7"),o=s("9ef1"),c=s("02f6"),d=s("a37d"),u=function(){var e=this,t=e._self._c;return e.stats?t("eq-window-simple",{staticClass:"admin-header-window mb-4 pb-0",staticStyle:{"font-family":"'Cerebri Sans', sans-serif",color:"white",padding:"10px","z-index":"1"},attrs:{title:e.stats.server_name,"bold-title":!0}},[t("div",{staticClass:"row align-items-center"},[t("div",{staticClass:"col-lg-12 col-sm-12 pl-0 pr-0 ml-0 text-center"},[t("div",{staticClass:"row align-items-center admin-header"},[t("div",{staticClass:"col-lg-2 col-sm-12 mt-3-mobile pl-0 pr-0"},e._l(e.serverStats.filter((function(e){return""!==e.value})),(function(s,a){return t("div",{key:a,staticClass:"row",staticStyle:{height:"15px"}},[t("div",{staticClass:"col-lg-6 col-3 p-0 m-0 text-right"},[t("span",{staticClass:"small font-weight-bold",staticStyle:{"font-size":"12px"}},[e._v("\n                  "+e._s(s.label)+"\n                ")])]),t("div",{staticClass:"col-lg-6 col-3 p-0 m-0 pl-3 text-left"},["Locked"!==s.label&&"World"!==s.label?t("span",{staticClass:"small",style:"font-size: 12px;"+(s.color?"color: "+s.color:"")},[e._v("\n                  "+e._s(s.value?s.value.toLocaleString():0)+"\n                ")]):e._e(),"Locked"===s.label?t("a",{staticClass:"small font-weight-bold text-muted",staticStyle:{"font-size":"12px"},attrs:{href:"javascript:void(0)"},on:{click:e.toggleServerLock}},[e.serverLocked?t("span",{staticClass:"text-danger"},[t("i",{staticClass:"fa fa-lock mr-1"}),e._v(" Locked\n                ")]):t("span",{staticClass:"text-success"},[t("i",{staticClass:"fa fa-unlock mr-1"}),e._v(" Unlocked\n                ")])]):e._e(),"World"===s.label?t("div",[t("server-process-button-component",{staticClass:"d-inline-block mr-3",staticStyle:{"z-index":"1000"},attrs:{"server-status":s.value}})],1):e._e()])])})),0),t("div",{staticClass:"col-lg-1 col-sm-12 mt-3-mobile pl-0 pr-0"},e._l(e.dashStats,(function(s,a){return t("div",{key:a,staticClass:"row",staticStyle:{height:"15px"}},[t("div",{staticClass:"col-lg-6 col-3 p-0 m-0 text-right"},[t("span",{staticClass:"small font-weight-bold",staticStyle:{"font-size":"12px"}},[e._v("\n                  "+e._s(s.label)+"\n                ")])]),t("div",{staticClass:"col-lg-6 col-3 p-0 m-0 pl-3 text-left"},["Locked"!==s.label&&"World"!==s.label?t("span",{staticClass:"small",staticStyle:{"font-size":"12px"}},[e._v("\n                  "+e._s(s.value?s.value.toLocaleString():"")+"\n                ")]):e._e()])])})),0),e._l(e.hostMetrics,(function(s,a){return t("div",{staticClass:"col-lg-2 col-sm-12 pl-0 pr-0 mt-3-mobile",staticStyle:{display:"inline-block"}},e._l(s,(function(s,a){return t("div",{key:a,staticClass:"row"},[t("div",{staticClass:"col-3 p-0 m-0 text-right",staticStyle:{"line-height":".8 !important"}},[t("span",{staticClass:"small font-weight-bold",staticStyle:{"font-size":"10px",opacity:".9"}},[e._v("\n                  "+e._s(s.label)+"\n                ")])]),"undefined"!==typeof s.percent?t("div",{staticClass:"col-6 p-0 m-0 mt-1",staticStyle:{"max-width":"120px"}},[t("eq-progress-bar",{staticStyle:{opacity:".95"},attrs:{percent:s.percent,"show-percent":!1,color:s.color}})],1):e._e(),t("div",{class:"p-0 m-0 text-left"+("undefined"===typeof s.percent?"col-9 ml-4 mb-1":"col-3"),staticStyle:{"line-height":".8 !important"}},[t("span",{class:" font-weight-bold"+("undefined"===typeof s.percent?"":"small text-muted"),staticStyle:{"font-size":"10px"}},[e._v("\n                  "+e._s(s.value)+"\n                ")])])])})),0)}))],2)])])]):e._e()},p=[],h=(s("ac4d"),s("8a81"),s("5df3"),s("1c4c"),s("6b54"),s("3b2b"),s("a481"),s("3b8d")),v=(s("55dd"),s("7f7f"),s("7514"),s("b2b1")),m=s("e327"),f=s("0d95"),y=s("73bf"),b=s("e4ba"),g=s("c582"),S=s("935a"),_=s("093e"),w=s("1f51");function k(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=C(e))||t&&e&&"number"==typeof e.length){s&&(e=s);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,l=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return i=e.done,e},e:function(e){l=!0,r=e},f:function(){try{i||null==s.return||s.return()}finally{if(l)throw r}}}}function C(e,t){if(e){if("string"==typeof e)return x(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?x(e,t):void 0}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=Array(t);s<t;s++)a[s]=e[s];return a}var B={name:"AdminHeader",components:{EqWindowSimple:_["a"],EqWindow:S["a"],EqProgressBar:b["a"],ServerProcessButtonComponent:v["a"]},data:function(){return{pageName:"",dashstats:{},stats:{},updateIntervalSeconds:1,sys:[],diskStats:{previousReadBytes:0,previousWriteBytes:0,readBytesPerSec:0,writeBytesPerSec:0},serverLocked:!1,stopMessage:"",shutdownTime:"",timer:null}},computed:{isWorldOnline:function(){if(!this.stats||!this.stats.main_process_stats)return!1;var e=this.stats.main_process_stats.find((function(e){return"world"===e.name||"world.exe"===e.name}));return!!(e&&e.elapsed>0)},serverStats:function(){return[{label:"World",value:this.stats&&this.isWorldOnline?"Online":"Offline"},{label:"Zoneservers",value:this.stats?this.stats.zone_count:0},{label:"Players Online",value:this.stats?this.stats.players_online:0},{label:"Uptime",value:this.stats&&this.stats.uptime?this.formatUptime(this.stats.uptime):"N/A"},{label:"Shutdown Timer",value:this.shutdownTime,color:"red"},{label:"Locked",value:this.serverLocked?"Yes":"No"}]},dashStats:function(){return[{label:"Accounts",value:this.dashstats&&this.dashstats.accounts?this.dashstats.accounts.toLocaleString():0},{label:"Characters",value:this.dashstats&&this.dashstats.characters?this.dashstats.characters.toLocaleString():0},{label:"Guilds",value:this.dashstats&&this.dashstats.guilds?this.dashstats.guilds.toLocaleString():0},{label:"Items",value:this.dashstats&&this.dashstats.items?this.dashstats.items.toLocaleString():0},{label:"NPCs",value:this.dashstats&&this.dashstats.npcs?this.dashstats.npcs.toLocaleString():0}]},hostMetrics:function(){var e,t=[],s=k(this.sys);try{for(s.s();!(e=s.n()).done;){var a=e.value,n=[{label:"Host",value:a.hostname},{label:"CPU",value:"".concat(a.cpu||"N/A"," %"),percent:parseFloat(a.cpu||0),color:this.getCpuLoadColor(a.cpu)},{label:"MEM",value:"".concat(a.mem||"N/A"," %"),percent:parseFloat(a.mem||0),color:"lightgreen"},{label:"DISK R",value:"".concat(a.diskStats.readBytesPerSec.toFixed(2)>1e3?0:a.diskStats.readBytesPerSec.toFixed(2)," MB/s"),percent:Math.min(a.diskStats.readBytesPerSec/100,100),color:"deepskyblue"},{label:"DISK W",value:"".concat(a.diskStats.writeBytesPerSec.toFixed(2)>1e3?0:a.diskStats.writeBytesPerSec.toFixed(2)," MB/s"),percent:Math.min(a.diskStats.writeBytesPerSec/100,100),color:"tomato"},{label:"NET DL",value:"".concat(this.bytesToMbytes(a.net["all"].bytes_recv_ps)>1e4?0:this.bytesToMbytes(a.net["all"].bytes_recv_ps)," Mbps"),percent:Math.min(this.bytesToMbytes(a.net["all"].bytes_recv_ps)/10,100),color:"limegreen"},{label:"NET UL",value:"".concat(this.bytesToMbytes(a.net["all"].bytes_sent_ps)>1e4?0:this.bytesToMbytes(a.net["all"].bytes_sent_ps)," Mbps"),percent:Math.min(this.bytesToMbytes(a.net["all"].bytes_sent_ps)/10,100),color:"limegreen"}];t.push(n)}}catch(r){s.e(r)}finally{s.f()}return t.sort((function(e,t){return"Host"===e[0].label&&e[0].value<t[0].value?-1:"Host"===e[0].label&&e[0].value>t[0].value?1:0})),t}},beforeDestroy:function(){clearInterval(this.timer),m["a"].$off("ROUTE_CHANGE",this.handleRouteChange),m["a"].$off("process-change"),y["a"].removeEventListener("message",this.handleWebsocketMessage)},created:function(){var e=this;m["a"].$on("ROUTE_CHANGE",this.handleRouteChange),y["a"].addEventListener("message",this.handleWebsocketMessage),this.loadServerStats(),m["a"].$on("process-change",function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(s){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.loadServerStats();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.getServerLockedStatus(),this.timer=setInterval((function(){document.hidden||e.loadServerStats()}),1e3),this.$route.meta&&this.$route.meta.title&&(this.pageName=this.$route.meta.title),f["SpireApi"].v1().get("eqemuserver/dashboard-stats").then((function(t){200===t.status&&(e.dashstats=t.data)}))},methods:{formatUptime:function(e){return e=e.replace("Worldserver Uptime |",""),e=e.replace(new RegExp(",","g"),""),e=e.replace("and",""),e=e.replace(" Days","d"),e=e.replace(" Day","d"),e=e.replace(" Weeks","w"),e=e.replace(" Week","w"),e=e.replace(" Months","m"),e=e.replace(" Month","m"),e=e.replace(" Hours","h"),e=e.replace(" Hour","h"),e=e.replace(" Minutes","m"),e=e.replace(" Minute","m"),e=e.replace(" Seconds","s"),e=e.replace(" Second","s"),e=e.replace(/^\s+|\s+$/g,""),e.trim()},getCpuLoadColor:function(e){return e>80?"red":e>50?"orange":"#2c7be5"},getServerLockedStatus:function(){var e=this;f["SpireApi"].v1().get("eqemuserver/get-lock-status").then((function(t){200===t.status&&(e.serverLocked=t.data.locked)}))},toggleServerLock:function(){var e=this;confirm("Are you sure you want to toggle the server lock?")&&f["SpireApi"].v1().post("eqemuserver/toggle-server-lock").then((function(t){200===t.status&&(e.serverLocked=t.data.locked,w["a"].toast(t.data.message))}))},loadServerStats:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:f["SpireApi"].v1().get("eqemuserver/server-stats").then((function(e){200===e.status&&(t.stats=e.data,t.$forceUpdate(),m["a"].$emit("server-stats",e.data))})),f["SpireApi"].v1().get("eqemuserver/system-all").then((function(e){var s=JSON.parse(JSON.stringify(t.sys)),a=[];if(200===e.status){var n,r=k(e.data);try{var i=function(){var e=n.value,t={cpu:0,mem:0,diskStats:{readBytes:0,writeBytes:0,previousReadBytes:null,previousWriteBytes:null,readBytesPerSec:0,writeBytesPerSec:0},net:{all:{bytes_recv:0,bytes_sent:0,bytes_recv_ps:0,bytes_sent_ps:0}}};if(s.length>0){var r=s.find((function(t){return t.hostname===e.hostname}));r&&(t=JSON.parse(JSON.stringify(r)))}t.cpu=Math.round(e.cpu),t.mem=Math.round(e.mem_percent),t.hostname=e.hostname;var i=e&&e.disk&&e.disk.length>0?e.disk[0]:null;if(i){var l=i.readBytes,o=i.writeBytes;null===t.diskStats.previousReadBytes||null===t.diskStats.previousWriteBytes?(t.diskStats.previousReadBytes=l,t.diskStats.previousWriteBytes=o,t.diskStats.readBytesPerSec=0,t.diskStats.writeBytesPerSec=0):(t.diskStats.readBytesPerSec=(l-t.diskStats.previousReadBytes)/1024/1024,t.diskStats.writeBytesPerSec=(o-t.diskStats.previousWriteBytes)/1024/1024,t.diskStats.previousReadBytes=l,t.diskStats.previousWriteBytes=o)}var c,d=k(e.net);try{for(d.s();!(c=d.n()).done;){var u=c.value;"undefined"===typeof t.net[u.name]&&(t.net[u.name]={bytes_recv:0,bytes_sent:0,bytes_recv_ps:0,bytes_sent_ps:0}),0===t.net[u.name].bytes_recv&&0===t.net[u.name].bytes_sent?(t.net[u.name].bytes_recv=u.bytesRecv,t.net[u.name].bytes_sent=u.bytesSent,t.net[u.name].bytes_recv_ps=0,t.net[u.name].bytes_sent_ps=0):(t.net[u.name].bytes_recv_ps=u.bytesRecv-t.net[u.name].bytes_recv,t.net[u.name].bytes_sent_ps=u.bytesSent-t.net[u.name].bytes_sent,t.net[u.name].bytes_recv=u.bytesRecv,t.net[u.name].bytes_sent=u.bytesSent)}}catch(p){d.e(p)}finally{d.f()}a.push(t)};for(r.s();!(n=r.n()).done;)i()}catch(l){r.e(l)}finally{r.f()}t.sys=a}}));case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),handleRouteChange:function(e){e&&e.meta&&e.meta.title&&(this.pageName=e.meta.title)},handleWebsocketMessage:function(e){if(e&&e.data){var t=JSON.parse(e.data);if("stopTimer"===t.type){var s=JSON.parse(t.message),a=s.time,n=s.type,r=this.calcRemainingTime(a);if(""===r)return this.stopMessage="",void(this.shutdownTime="");this.stopMessage="".concat(n.charAt(0).toUpperCase()+n.slice(1)," in ").concat(r),this.shutdownTime=r}}},calcRemainingTime:function(e){return g["a"].calculateRemainingTimeServerReboot(e)},bytesToMbytes:function(e){return parseFloat(8*e/1024/1024).toFixed(2)}}},M=B,L=(s("6359"),s("2877")),R=Object(L["a"])(M,u,p,!1,null,"df2999de",null),T=R.exports,A=s("49c5"),W={components:{AdminHeader:T,Navbar:d["a"],ContentArea:c["a"],Header:l["a"],Footer:o["a"],BackToTop:i["a"]},data:function(){return{isLocal:!0}},created:function(){return Object(r["d"])(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,A["a"].init();case 2:this.isLocal=A["a"].isAppLocal();case 3:case"end":return e.stop()}}),e,this)})))}},N=W,O=Object(L["a"])(N,a,n,!1,null,null,null);t["default"]=O.exports},c216:function(e,t,s){}}]);